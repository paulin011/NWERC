\documentclass[9pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[left=0.3cm,right=0.3cm,top=0.6cm,bottom=0.6cm,includehead]{geometry}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{titlesec}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{fancyhdr} % For header

% Note: removed `extsizes` and `showframe` (they previously overrode geometry and were used for diagnostics)

% Compact spacing
\setlength{\parindent}{0pt}
\setlength{\parskip}{1.5pt}
\setlength{\columnsep}{4pt} % Reduce space between columns so each column is wider
\titlespacing*{\section}{0pt}{5pt}{2pt}
\titlespacing*{\subsection}{0pt}{3pt}{1.5pt}
\setlist{nosep, leftmargin=*}

% Code listing style
\lstset{
    language=Python,
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{gray}\itshape,
    stringstyle=\color{red},
    % place line numbers on the left but ensure they and the frame are
    % fully inside the column by shrinking the listing content width to
    % account for frame rules and padding
    numbers=left,
    numberstyle=\tiny\color{gray},
    numbersep=6pt,
    breaklines=true,
    showstringspaces=false,
    tabsize=2,
    frame=single,
    frameround=tttt,
    columns=flexible,
    keepspaces=true,
    aboveskip=3pt,
    belowskip=3pt,
    % make the listing width slightly smaller than the column to avoid
    % any overflow from frames or numbers into the gutter
    linewidth=\dimexpr\columnwidth-2\fboxsep-2\fboxrule\relax,
    % small inner left margin (so numbers sit inside the frame area)
    xleftmargin=6pt,
    xrightmargin=0pt,
    framesep=2pt
}

% Hyperref setup
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Python ICPC Cheatsheet},
    pdfauthor={ICPC Contestant},
}

% Header settings
\setlength{\headheight}{14pt}
\setlength{\headsep}{4pt}
\pagestyle{fancy}
\fancyhf{}% clear header/footer
\fancyhead[L]{\small Universität zu Köln}
\fancyhead[R]{\small\thepage}
\renewcommand{\headrulewidth}{0pt} % no rule for tighter look

\begin{document}
% Diagnostics: print layout dimensions to the log for analysis
% \typeout{PAGEWIDTH=\the\paperwidth}
% \typeout{TEXTWIDTH=\the\textwidth}
% \typeout{COLUMNSEP=\the\columnsep}
% \typeout{LEFTMARGIN=\the\oddsidemargin}

\begin{center}
    {\Large\bfseries Python ICPC Cheatsheet}\\[0.2em]
    {\small Comprehensive Reference for Competitive Programming}
\end{center}

\begin{multicols}{2}
\tableofcontents
\end{multicols}

\begin{multicols}{2}
\raggedcolumns

% Include all sections
\input{sections/01_io}

\input{sections/02_data_structures}

\input{sections/03_strings}

\input{sections/04_math}

\input{sections/05_number_theory}

\input{sections/06_graphs}

\input{sections/07_shortest_paths}

\input{sections/08_topological_sort}

\input{sections/09_union_find}

\input{sections/10_binary_search}

\input{sections/11_dynamic_programming}

\input{sections/12_arrays}

\input{sections/13_advanced_structures}

\input{sections/14_bit_manipulation}

\input{sections/15_matrix}

\input{sections/16_tips}

\input{sections/17_geometry}

\input{sections/18_flow}

\input{sections/19_advanced_python.tex}

\input{sections/20_problem_procedure}

\end{multicols}

\end{document}
